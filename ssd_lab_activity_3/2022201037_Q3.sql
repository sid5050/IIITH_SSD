SELECT DISTINCT Mgr_ssn, COUNT(DISTINCT Pno) FROM WORKS_ON JOIN (SELECT DISTINCT Mgr_ssn FROM DEPARTMENT JOIN (SELECT DNUM FROM PROJECT WHERE Pname="ProductY") AS DEPTNUM WHERE DEPARTMENT.Dnumber = DEPTNUM.DNUM) AS MGRID WHERE WORKS_ON.Essn = MGRID.Mgr_ssn GROUP BY Mgr_ssn;
