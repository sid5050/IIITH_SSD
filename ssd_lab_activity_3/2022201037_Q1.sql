SELECT DISTINCT EMPLOYEE.Fname,EMPLOYEE.Minit,EMPLOYEE.Lname,EMPLOYEE.Ssn, MGRDEPT.Dno, MGRDEPT.DNAME FROM EMPLOYEE JOIN (SELECT DISTINCT DEPARTMENT.Mgr_ssn AS MGR_SSN,DEPARTMENT.Dnumber AS DNO, DEPARTMENT.Dname AS DNAME FROM DEPARTMENT INNER JOIN (SELECT distinct(DEPT_LOCATIONS.Dnumber) FROM WORKS_ON, PROJECT, DEPT_LOCATIONS WHERE WORKS_ON.Pno = PROJECT.Pnumber AND WORKS_ON.Hours < 40 AND PROJECT.Dnum = DEPT_LOCATIONS.Dnumber) AS DEPT) AS MGRDEPT ON EMPLOYEE.Ssn = MGRDEPT.MGR_SSN;
