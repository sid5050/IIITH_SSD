SELECT DISTINCT DEPT_LOCATIONS.Dnumber AS DEPT_ID, DEPT_DATA.Dname AS DEPTNAME, COUNT(*) AS LOCATIONS FROM DEPT_LOCATIONS JOIN (SELECT DEPT.Dnumber, DEPARTMENT.Dname FROM DEPARTMENT JOIN (SELECT DEPARTMENT.Dnumber, COUNT(SEX) AS FEMALES FROM DEPENDENT JOIN DEPARTMENT WHERE DEPARTMENT.Mgr_ssn = DEPENDENT.Essn AND DEPENDENT.Sex="F" GROUP BY DEPARTMENT.Dnumber HAVING FEMALES >= 2) AS DEPT WHERE DEPT.Dnumber=DEPARTMENT.Dnumber) AS DEPT_DATA WHERE DEPT_DATA.Dnumber=DEPT_LOCATIONS.Dnumber GROUP BY DEPT_LOCATIONS.Dnumber;
